<?php
/**
 * Copyright © 2016 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */
use Magento\Catalog\Block\Product;
?>
<?php
/**
 * Product list template
 *
 * @var $block \Magento\Catalog\Block\Product\ListProduct
 */
?>
<?php
// using object Managr 
$_productCollection = $block->getLoadedProductCollection();
$_helper = $this->helper('Magento\Catalog\Helper\Output');
$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
$productModel = $objectManager->get('Magento\Catalog\Model\Product');
$image = 'category_page_grid';


$productCollection = $objectManager->create('Magento\Catalog\Model\ResourceModel\Product\CollectionFactory');
$category = $objectManager->get('Magento\Framework\Registry')->registry('current_category');
$category = $objectManager->create('Magento\Catalog\Model\Category')->load($category->getId());
$collection = $productCollection->create()
         ->addAttributeToSelect('*')
        ->addCategoryFilter($category)
         ->load();
?>	
       <?php echo $block->getLayout()->createBlock('Magento\Cms\Block\Block')->setBlockId('request-a-free-swatch')->toHtml();?>   
       
  
         <div class="products wrapper">
        <?php // $_product \Magento\Catalog\Model\Product */ ?>
        <?php foreach ($collection as $_product): ?>
         <div class="product-item-info" data-container="product-grid">
    <?php 
	 // For loading Image 
	 $_imagehelper = $this->helper('Magento\Catalog\Helper\Image');
	 $productImage = $_imagehelper->init($_product, $image)->constrainOnly(FALSE)->keepAspectRatio(TRUE)->keepFrame(FALSE)->resize(250)->getUrl();
	 ?>
     
      <?php //  Loading Product Image ?>
      
     <a class="product-item-link" href="#"> <img id="imageLoader" src="<?php echo $productImage; ?>" width="150" height="150"/></a>
     <div class="product details product-item-details">
     <?php $_productName = $block->stripTags($_product->getName(), null, true); ?>
     
        <?php //  Loading Product Name ?>                
       <div class="product name product-item-name">
           
     <?php  echo $_helper->productAttribute($_product, $_product->getName(), 'name'); ?> </a></div>
                                 
      <?php //  Loading Zoom  Name ?>  
      <a class="icon-zoom-in" href="<?php echo $productImage ?>">Zoom</a>
      
   <?php //  Loading Add to cart Button with form key  ?>
   <?php // using List helper for Add to cart 
    $listBlock = $objectManager->get('\Magento\Catalog\Block\Product\ListProduct');
    $addToCartUrl =  $listBlock->getAddToCartUrl($_product); 
   ?>
 <form data-role="tocart-form" action="<?php echo $addToCartUrl; ?>" method="post">
 <?php echo $block->getBlockHtml('formkey')?>
 <button type="submit"
  title="<?php echo $block->escapeHtml(__('Add to Bag')); ?>"
 class="action tocart primary">
  <span><?php /* @escapeNotVerified */ echo __('Add to Bag') ?></span>
 </form>     
 </div>  
</div><?php endforeach; ?>
  </div>
  
   
   <script type="text/x-magento-init">
        {
            "[data-role=tocart-form], .form.map.checkout": {
                "catalogAddToCart": {}
            }
        }
   </script>
  <script type="text/javascript">
   require(['jquery'], function ($) {
   $(document).ready(function() {
     $('.icon-zoom-in').fancybox({
    fitToView: false,
    beforeShow: function () {
        this.width = 500;
        this.height = 500;
    }
    });
   

	/* Different effects */
	// Change title type, overlay closing speed		
	$(".fancybox-effects-a").fancybox({
				helpers: {
					title : {
						type : 'outside'
					},
					overlay : {
						speedOut : 0
					}
				}
			});		
 // Disable opening and closing animations, change title type
	$(".fancybox-effects-b").fancybox({
				openEffect  : 'none',
				closeEffect	: 'none',

				helpers : {
					title : {
						type : 'over'
					}
				}
			});		
			
/*Button helper. Disable animations, hide close button, change title type and content */
	$('.fancybox-buttons').fancybox({
				openEffect  : 'none',
				closeEffect : 'none',

				prevEffect : 'none',
				nextEffect : 'none',

				closeBtn  : false,

				helpers : {
					title : {
						type : 'inside'
					},
					buttons	: {}
				},

				afterLoad : function() {
					this.title = 'Image ' + (this.index + 1) + ' of ' + this.group.length + (this.title ? ' - ' + this.title : '');
				}
			});		
/*  Thumbnail helper. Disable animations, hide close button, arrows and slide to next gallery item if clicked */			
    $('.fancybox-thumbs').fancybox({
				prevEffect : 'none',
				nextEffect : 'none',

				closeBtn  : false,
				arrows    : false,
				nextClick : true,

				helpers : {
					thumbs : {
						width  : 50,
						height : 50
					}
				}
			});
}); 
});       
           
			
	</script>			

<style type="text/css">
		.title {
			display:none;
        }
     .fancybox-inner {
       width:300px;
      height:400px;
  } 
  .fancybox-item fancybox-close {
  background-image: url(images/fancybox_sprite.png);
  }
           
            </style> 
   
  